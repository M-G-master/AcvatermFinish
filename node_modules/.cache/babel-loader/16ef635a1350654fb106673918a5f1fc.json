{"ast":null,"code":"import _toConsumableArray from\"C:/\\u041F\\u0440\\u043E\\u044D\\u043A\\u0442\\u044B/AKVATERM/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/\\u041F\\u0440\\u043E\\u044D\\u043A\\u0442\\u044B/AKVATERM/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/\\u041F\\u0440\\u043E\\u044D\\u043A\\u0442\\u044B/AKVATERM/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/\\u041F\\u0440\\u043E\\u044D\\u043A\\u0442\\u044B/AKVATERM/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from'react';import{useSelector}from'react-redux';import{useNavigate}from'react-router-dom';import Categories from'../components/Categories';import Sort from'../components/Sort';import PizzaBlock from'../components/PizzaBlock';import Skeleton from'../components/PizzaBlock/Skeleton';import Pagination from'../components/Pagination';import{useAppDispatch}from'../redux/store';import{selectFilter}from'../redux/filter/selectors';import{selectPizzaData}from'../redux/pizza/selectors';import{fetchPizzas}from'../redux/pizza/asyncActions';import{setCategoryId,setCurrentPage}from'../redux/filter/slice';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Home=function Home(){var navigate=useNavigate();var dispatch=useAppDispatch();var isMounted=React.useRef(false);import('../utils/math').then(function(math){console.log(math.add(777,888));});var _useSelector=useSelector(selectPizzaData),items=_useSelector.items,status=_useSelector.status;var _useSelector2=useSelector(selectFilter),categoryId=_useSelector2.categoryId,sort=_useSelector2.sort,currentPage=_useSelector2.currentPage,searchValue=_useSelector2.searchValue;var onChangeCategory=React.useCallback(function(index){dispatch(setCategoryId(index));},[]);var onChangePage=function onChangePage(page){dispatch(setCurrentPage(page));};var getPizzas=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var sortBy,order,category,search;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:sortBy=sort.sortProperty.replace('-','');order=sort.sortProperty.includes('-')?'asc':'desc';category=categoryId>0?\"category=\".concat(categoryId):'';search=searchValue?\"&search=\".concat(searchValue):'';dispatch(fetchPizzas({sortBy:sortBy,order:order,category:category,search:search,currentPage:String(currentPage)}));window.scrollTo(0,0);case 6:case\"end\":return _context.stop();}}},_callee);}));return function getPizzas(){return _ref.apply(this,arguments);};}();// Если........первый рендер\n// React.useEffect(() => {\n//   if (isMounted.current) {\n//     const params = {\n//       categoryId: categoryId > 0 ? categoryId : null,\n//       sortProperty: sort.sortProperty,\n//       currentPage,\n//     };\n//     const queryString = qs.stringify(params, { skipNulls: true });\n//     navigate(`/?${queryString}`);\n//   }\n//   if (!window.location.search) {\n//     dispatch(fetchPizzas({} as SearchPizzaParams));\n//   }\n// }, [categoryId, sort.sortProperty, searchValue, currentPage]);\nReact.useEffect(function(){getPizzas();},[categoryId,sort.sortProperty,searchValue,currentPage]);// Парсим ....... первом рендере\n// React.useEffect(() => {\n//   if (window.location.search) {\n//   const params = qs.parse(window.location.search.substring(1)) as unknown as SearchPizzaParams;\n//   const sort = sortList.find((obj) => obj.sortProperty === params.sortBy);\n//   dispatch(\n//     setFilters({\n//     searchValue: params.search,\n//     categoryId: Number(params.category),\n//     currentPage: Number(params.currentPage),\n//     sort: sort || sortList[0]\n//   })\n//   )\n//   }\n//   isMounted.current = true;\n// }, []);\nvar pizzas=items.map(function(obj){return/*#__PURE__*/_jsx(PizzaBlock,_objectSpread({},obj),obj.id);});var skeletons=_toConsumableArray(new Array(6)).map(function(_,index){return/*#__PURE__*/_jsx(Skeleton,{},index);});return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"content__top\",children:[/*#__PURE__*/_jsx(Categories,{value:categoryId,onChangeCategory:onChangeCategory}),/*#__PURE__*/_jsx(Sort,{value:sort})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"content__title\",children:\"\\u0423\\u0441\\u0456 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0438\"}),status==='error'?/*#__PURE__*/_jsxs(\"div\",{className:\"content__error-info\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0412\\u0438\\u0439\\u0448\\u043B\\u0430 \\u043F\\u043E\\u043C\\u0438\\u043B\\u043A\\u0430 \\uD83D\\uDE15\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u041D\\u0430\\u0436\\u0430\\u043B\\u044C, \\u043D\\u0435 \\u0432\\u0434\\u0430\\u043B\\u043E\\u0441\\u044F \\u0437\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0438\\u0442\\u0438 \\u0442\\u043E\\u0432\\u0430\\u0440, \\u043F\\u0435\\u0440\\u0435\\u0437\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0442\\u0435 \\u0441\\u0442\\u043E\\u0440\\u0456\\u043D\\u043A\\u0443, \\u0430\\u0431\\u043E \\u0441\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u043F\\u0456\\u0437\\u043D\\u0456\\u0448\\u0435\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"content__items\",children:status==='loading'?skeletons:pizzas}),/*#__PURE__*/_jsx(Pagination,{currentPage:currentPage,onChangePage:onChangePage})]});};export default Home;","map":{"version":3,"names":["React","useSelector","useNavigate","Categories","Sort","PizzaBlock","Skeleton","Pagination","useAppDispatch","selectFilter","selectPizzaData","fetchPizzas","setCategoryId","setCurrentPage","Home","navigate","dispatch","isMounted","useRef","then","math","console","log","add","items","status","categoryId","sort","currentPage","searchValue","onChangeCategory","useCallback","index","onChangePage","page","getPizzas","sortBy","sortProperty","replace","order","includes","category","search","String","window","scrollTo","useEffect","pizzas","map","obj","id","skeletons","Array","_"],"sources":["C:/Проэкты/AKVATERM/src/Pages/Home.tsx"],"sourcesContent":["import React from 'react';\r\nimport qs from 'qs';\r\nimport { useSelector } from 'react-redux';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport Categories from '../components/Categories';\r\nimport Sort, { sortList } from '../components/Sort';\r\nimport PizzaBlock from '../components/PizzaBlock';\r\nimport Skeleton from '../components/PizzaBlock/Skeleton';\r\nimport Pagination from '../components/Pagination';\r\nimport { SearchPizzaParams } from '../redux/pizza/slice';\r\nimport { useAppDispatch } from '../redux/store';\r\nimport { selectFilter } from '../redux/filter/selectors';\r\nimport { selectPizzaData } from '../redux/pizza/selectors';\r\nimport { fetchPizzas } from '../redux/pizza/asyncActions';\r\nimport { setCategoryId, setCurrentPage, setFilters } from '../redux/filter/slice';\r\n\r\nconst Home: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const dispatch = useAppDispatch();\r\n  const isMounted = React.useRef(false);\r\n\r\n  import('../utils/math').then((math) => {\r\n    console.log(math.add(777, 888));\r\n  });\r\n\r\n  const { items, status } = useSelector(selectPizzaData);\r\n  const { categoryId, sort, currentPage, searchValue } = useSelector(selectFilter);\r\n  const onChangeCategory = React.useCallback((index: number) => {\r\n    dispatch(setCategoryId(index));\r\n  }, []);\r\n  const onChangePage = (page: number) => {\r\n    dispatch(setCurrentPage(page));\r\n  };\r\n  const getPizzas = async () => {\r\n    const sortBy = sort.sortProperty.replace('-', '');\r\n    const order = sort.sortProperty.includes('-') ? 'asc' : 'desc';\r\n    const category = categoryId > 0 ? `category=${categoryId}` : '';\r\n    const search = searchValue ? `&search=${searchValue}` : '';\r\n\r\n    dispatch(\r\n      fetchPizzas({\r\n        sortBy,\r\n        order,\r\n        category,\r\n        search,\r\n        currentPage: String(currentPage),\r\n      }),\r\n    );\r\n\r\n    window.scrollTo(0, 0);\r\n  };\r\n\r\n  // Если........первый рендер\r\n  // React.useEffect(() => {\r\n  //   if (isMounted.current) {\r\n  //     const params = {\r\n  //       categoryId: categoryId > 0 ? categoryId : null,\r\n  //       sortProperty: sort.sortProperty,\r\n  //       currentPage,\r\n  //     };\r\n\r\n  //     const queryString = qs.stringify(params, { skipNulls: true });\r\n\r\n  //     navigate(`/?${queryString}`);\r\n  //   }\r\n\r\n  //   if (!window.location.search) {\r\n  //     dispatch(fetchPizzas({} as SearchPizzaParams));\r\n  //   }\r\n  // }, [categoryId, sort.sortProperty, searchValue, currentPage]);\r\n\r\n  React.useEffect(() => {\r\n    getPizzas();\r\n  }, [categoryId, sort.sortProperty, searchValue, currentPage]);\r\n\r\n  // Парсим ....... первом рендере\r\n  // React.useEffect(() => {\r\n  //   if (window.location.search) {\r\n  //   const params = qs.parse(window.location.search.substring(1)) as unknown as SearchPizzaParams;\r\n  //   const sort = sortList.find((obj) => obj.sortProperty === params.sortBy);\r\n  //   dispatch(\r\n  //     setFilters({\r\n  //     searchValue: params.search,\r\n  //     categoryId: Number(params.category),\r\n  //     currentPage: Number(params.currentPage),\r\n  //     sort: sort || sortList[0]\r\n  //   })\r\n  //   )\r\n  //   }\r\n  //   isMounted.current = true;\r\n  // }, []);\r\n\r\n  const pizzas = items.map((obj: any) => <PizzaBlock key={obj.id} {...obj} />);\r\n  const skeletons = [...new Array(6)].map((_, index) => <Skeleton key={index} />);\r\n  return (\r\n    <div className=\"container\">\r\n      <div className=\"content__top\">\r\n        <Categories value={categoryId} onChangeCategory={onChangeCategory} />\r\n        <Sort value={sort} />\r\n      </div>\r\n      <h2 className=\"content__title\">Усі товари</h2>\r\n      {status === 'error' ? (\r\n        <div className=\"content__error-info\">\r\n          <h2>Вийшла помилка 😕</h2>\r\n          <p>\r\n            Нажаль, не вдалося завантажити товар, перезавантажте сторінку, або спробуйте пізніше\r\n          </p>\r\n        </div>\r\n      ) : (\r\n        <div className=\"content__items\">{status === 'loading' ? skeletons : pizzas}</div>\r\n      )}\r\n      <Pagination currentPage={currentPage} onChangePage={onChangePage} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}